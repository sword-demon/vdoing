---
title: IOC容器原理
date: 2022-01-02 23:20:43
permalink: /pages/419ce1/
categories:
    - 《Java》学习
    - Spring
tags:
    - null
---

## 概念

> 控制反转(Inversion of Control)，是面向对象编程中的一种设计原则，可以用来减低计算机之间的**耦合读**。其中最常见的方式叫做**依赖注入**(Dependency Injection, 简称**DI**)。

1.  **把对象创建和对象之间的调用过程，交给 Spring 进行管理**
2.  目的：为了耦合度降低
3.  入门案例就是 IOC 实现

## IOC 底层原理

1.  `xml`解析、工厂设计模式、反射

原始方式

<p align="center"><img src="https://gitee.com/wxvirus/img/raw/master/img/20220102212458.png" alt="两个类之间生成对象调用方法1" /></p>

于是有了**工厂模式**来降低耦合度

```java
class UserDao {
    void add() {
        // ...
    }
}
```

```java
class UserFactory {
    public static UserDao getDao() {
        return new UserDao();
    }
}
```

```java
class UserService {
    void execute() {
        UserDao dao = UserFactory.getDao();
        dao.add();
    }
}
```

使用工厂来降低了`service`和`dao`之间的耦合度。但是你会发现，工厂还是会有耦合。

:::tip 目的

耦合度降低到最低限度

:::

## IOC 过程

1.  配置`xml`文件，配置创建的对象

    ```xml
    <!-- 配置User类对象创建 -->
    <bean id="user" class="com.wx.spring5.User"/>
    ```

2.  有`service`类和`dao`类，创建工厂类

    ```java
    class UserFactory {
        public static UserDao getDao() {
            // 通过xml的解析 + 反射来获取类对象
            String classValue = class属性值; // xml 解析得到 com.wx.spring5.User

            // 通过反射创建对象
            // 得到类的字节码文件
            Class clazz = Class.forName(classValue);

            // 创建对象
            return (UserDao) clazz.newInstance();
        }
    }
    ```

**进一步降低耦合度**

> 通过这样的方式，我们以后就算需要改内容，也只需要改配置文件即可。
